{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\n//import qs from \"qs\";\nimport { store } from \"@/store\";\nimport router from \"@/router\";\nclass HTTP {\n  constructor(url) {\n    var instance = axios.create({\n      baseURL: process.env.VUE_APP_SERVICE_URL,\n      json: true\n    });\n    instance.interceptors.request.use(function (config) {\n      store.commit(\"showLoading\");\n      const auth = store.state.auth;\n      if (auth.isAuthenticated) config.headers.Authorization = `Bearer ${auth.current.token}`;\n      return config;\n    }, function (error) {\n      return Promise.reject(error);\n    });\n    instance.interceptors.response.use(function (response) {\n      store.commit(\"hideLoading\");\n      return response;\n    }, function (error) {\n      store.commit(\"hideLoading\");\n      if (error.response) {\n        if (error.response.status === 400) {\n          store.commit(\"notifyError\", error.response.data);\n        } else if (error.response.status === 401) {\n          store.dispatch(\"account/signOut\").then(() => {\n            router.push(\"/login\");\n          });\n        } else if (error.response.status === 403) {\n          store.dispatch(\"account/signOut\").then(() => {\n            router.push(\"/login\");\n          });\n        } else if (error.response.status === 500) {\n          store.commit(\"notifyError\", {\n            Errors: [{\n              Message: \"Ocorreu um erro no sistema, por favor, tente novamente mais tarde.\"\n            }]\n          });\n        }\n      }\n      return Promise.reject(error);\n    });\n    instance.url = url;\n    instance.getOne = function (id) {\n      return this.get(this.url + `/${id}`);\n    };\n    instance.getAll = function () {\n      return this.get(this.url);\n    };\n    instance.update = function (toUpdate, correlationId) {\n      let url = this.url;\n      if (correlationId) {\n        Object.assign(toUpdate, {\n          CorrelationId: correlationId\n        });\n      }\n      return this.put(url, toUpdate);\n    };\n    instance.create = function (toCreate) {\n      return this.post(this.url, toCreate);\n    };\n    instance.remove = function (id) {\n      return this.delete(this.url + `?correlationId=${id}`);\n    };\n    return instance;\n  }\n}\nexport default HTTP;","map":{"version":3,"names":["axios","store","router","HTTP","constructor","url","instance","create","baseURL","process","env","VUE_APP_SERVICE_URL","json","interceptors","request","use","config","commit","auth","state","isAuthenticated","headers","Authorization","current","token","error","Promise","reject","response","status","data","dispatch","then","push","Errors","Message","getOne","id","get","getAll","update","toUpdate","correlationId","Object","assign","CorrelationId","put","toCreate","post","remove","delete"],"sources":["C:/Projetos/Me/MySchool/src/MySchool.Web/myschool/src/utils/http.js"],"sourcesContent":["import axios from \"axios\";\r\n//import qs from \"qs\";\r\nimport { store } from \"@/store\";\r\nimport router from \"@/router\";\r\n\r\nclass HTTP {\r\n  constructor(url) {\r\n    var instance = axios.create({\r\n      baseURL: process.env.VUE_APP_SERVICE_URL,\r\n      json: true,\r\n    });\r\n\r\n    instance.interceptors.request.use(\r\n      function(config) {\r\n        store.commit(\"showLoading\");\r\n        const auth = store.state.auth;\r\n        if (auth.isAuthenticated)\r\n          config.headers.Authorization = `Bearer ${auth.current.token}`;\r\n        return config;\r\n      },\r\n      function(error) {\r\n        return Promise.reject(error);\r\n      }\r\n    );\r\n\r\n    instance.interceptors.response.use(\r\n      function(response) {\r\n        store.commit(\"hideLoading\");\r\n        return response;\r\n      },\r\n      function(error) {\r\n        store.commit(\"hideLoading\");\r\n        if (error.response) {\r\n          if (error.response.status === 400) {\r\n            store.commit(\"notifyError\", error.response.data);\r\n          } else if (error.response.status === 401) {\r\n            store.dispatch(\"account/signOut\").then(() => {\r\n              router.push(\"/login\");\r\n            });\r\n          } else if (error.response.status === 403) {\r\n            store.dispatch(\"account/signOut\").then(() => {\r\n              router.push(\"/login\");\r\n            });\r\n          } else if (error.response.status === 500) {\r\n            store.commit(\"notifyError\", {\r\n              Errors: [\r\n                {\r\n                  Message:\r\n                    \"Ocorreu um erro no sistema, por favor, tente novamente mais tarde.\",\r\n                },\r\n              ],\r\n            });\r\n          }\r\n        }\r\n        return Promise.reject(error);\r\n      }\r\n    );\r\n\r\n    instance.url = url;\r\n\r\n    instance.getOne = function(id) {\r\n      return this.get(this.url + `/${id}`);\r\n    };\r\n\r\n    instance.getAll = function() {\r\n      return this.get(this.url);\r\n    };\r\n\r\n\r\n    instance.update = function(toUpdate, correlationId) {\r\n      let url = this.url;\r\n      if (correlationId) {\r\n        Object.assign(toUpdate, { CorrelationId: correlationId });\r\n      }\r\n      return this.put(url, toUpdate);\r\n    };\r\n\r\n    instance.create = function(toCreate) {\r\n      return this.post(this.url, toCreate);\r\n    };\r\n\r\n    instance.remove = function(id) {\r\n      return this.delete(this.url + `?correlationId=${id}`);\r\n    };\r\n    \r\n    return instance;\r\n  }\r\n}\r\n\r\nexport default HTTP;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}